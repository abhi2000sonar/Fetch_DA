1. Who Are Fetch’s Power Users?
Power users are defined as the most active and valuable users based on:
Scanning the highest number of receipts.
Contributing the most in total sales.

Query to Identify Power Users by Receipts Scanned:
select 
    u.id as user_id,
    count(distinct t.receipt_id) as total_receipts,
    sum(t.sale) as total_sales
from 
    transactions t
join 
    users u on t.user_id = u.id
group by 
    u.id
order by 
    total_receipts desc
limit 10;
This query identifies the top 10 users with the highest number of scanned receipts and their respective sales contributions.

2. Which Is the Leading Brand in the Dips & Salsa Category?
The leading brand in the Dips & Salsa category is determined by:
The number of receipts scanned for products in this category.
The total sales volume generated by these products.

Query to Find the Leading Brand:
select 
    p.brand,
    count(distinct t.receipt_id) as receipts_scanned,
    sum(t.sale) as total_sales
from 
    transactions t
join 
    products p on t.barcode = p.barcode
where 
    p.category_3 = 'dips & salsa'
group by 
    p.brand
order by 
    total_sales desc
limit 1;
This query identifies the brand with the highest total sales in the Dips & Salsa category. To prioritize receipt counts instead, change order by total_sales desc to order by receipts_scanned desc.

3. At What Percent Has Fetch Grown Year Over Year?
Fetch’s growth is evaluated by:
Total sales generated each year.
Increases in user activity, such as receipts scanned or active users.

Query to Calculate Year-over-Year Growth:
select 
    year(t.scan_date) as year,
    sum(t.sale) as total_sales,
    lag(sum(t.sale)) over (order by year(t.scan_date)) as previous_year_sales,
    ((sum(t.sale) - lag(sum(t.sale)) over (order by year(t.scan_date))) / 
    lag(sum(t.sale)) over (order by year(t.scan_date))) * 100 as yoy_growth_percentage
from 
    transactions t
group by 
    year(t.scan_date)
order by 
    year;
This query calculates the YoY growth in total sales. To evaluate growth in receipts scanned, replace sum(t.sale) with count(distinct t.receipt_id). Similarly, for user growth, join the users table and use count(distinct u.id).

Summary of Queries
Power Users: Identified using total receipts scanned and sales contributions.
Leading Brand in Dips & Salsa: Determined based on total sales or receipts scanned.
Year-over-Year Growth: Evaluated as a percentage increase in sales, receipts, or user activity.
